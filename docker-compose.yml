version: "3.1"

# Create ./.env and <config_vol_path>/config.yml before running

services:
  homey-api:
    container_name: homey-api
    hostname: homey-api
    image: vlfldr/homey-api:latest
    build: ./homey-api/
    user: "${HOMEY_API_DOCKER_USER_ID}:${HOMEY_API_DOCKER_GROUP_ID}"
    env_file: .env
    ports: 
      - "9101:9101"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ~/homey-data:/code/config

  homey:
    container_name: homey
    hostname: homey
    image: vlfldr/homey:latest
    build: ./homey/
    ports:
      - "8080:80"
    volumes:
      - ~/homey-data:/app/data
    depends_on:
      - "homey-api"
